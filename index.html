
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì–´ì‚¬ì¶œë˜ ì›í„°ì¹˜ ë°œì£¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; -webkit-tap-highlight-color: transparent; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        button { touch-action: manipulation; }
        /* ìˆ«ì ì…ë ¥ì¹¸ ìŠ¤í”¼ë„ˆ ì œê±° */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 h-screen flex flex-col">

<!-- 1. ìƒë‹¨ í—¤ë” -->
<header class="bg-white shadow-sm z-20 px-4 py-3 flex justify-between items-center shrink-0 border-b border-gray-200">
    <div>
        <h1 class="text-xl font-bold text-blue-600">ì–´ì‚¬ì¶œë˜ ë°œì£¼</h1>
        <p class="text-xs text-gray-500 font-medium">ì£¼ì•ˆì  | ì¬ê³  & ì£¼ë¬¸ ê´€ë¦¬</p>
    </div>
    <button onclick="resetAll()" class="px-3 py-1.5 bg-red-50 text-red-500 rounded-lg text-xs font-bold hover:bg-red-100 transition-colors flex items-center">
        <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
        ì „ì²´ ì´ˆê¸°í™”
    </button>
</header>

<!-- 2. ì¹´í…Œê³ ë¦¬ íƒ­ -->
<nav class="bg-white border-b border-gray-200 shrink-0 sticky top-0 z-10">
    <div class="flex overflow-x-auto hide-scrollbar px-2" id="category-tabs">
        <!-- JSë¡œ ìƒì„±ë¨ -->
    </div>
</nav>

<!-- 3. ìƒí’ˆ ëª©ë¡ -->
<main class="flex-1 overflow-y-auto p-3 pb-32 bg-gray-50" id="item-list">
    <!-- JSë¡œ ìƒì„±ë¨ -->
</main>

<!-- 4. í•˜ë‹¨ ì£¼ë¬¸ ìš”ì•½ ë°” -->
<footer class="bg-white border-t border-gray-200 px-4 py-3 fixed bottom-0 w-full max-w-md mx-auto left-0 right-0 shadow-[0_-4px_15px_-3px_rgba(0,0,0,0.1)] z-30 rounded-t-2xl">
    <div class="flex justify-between items-center mb-3">
        <div>
            <span class="text-xs text-gray-400 block">ì´ ì…ë ¥ í’ˆëª©</span>
            <span class="font-bold text-gray-800 text-lg"><span id="total-items">0</span>ê°œ í’ˆëª©</span>
        </div>
        <div class="text-right">
            <span class="text-xs text-gray-400 block">ì˜¤ëŠ˜ ë‚ ì§œ</span>
            <span class="font-bold text-blue-600 text-lg" id="today-date"></span>
        </div>
    </div>
    <button onclick="openModal()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3.5 rounded-xl text-lg shadow-lg transition-transform active:scale-[0.98] flex justify-center items-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
        <span>ë°œì£¼ì„œ ìƒì„± & ì „ì†¡</span>
    </button>
</footer>

<!-- 5. ëª¨ë‹¬ (ë¯¸ë¦¬ë³´ê¸°) -->
<div id="order-modal" class="fixed inset-0 bg-black/60 z-50 hidden flex items-end sm:items-center justify-center transition-opacity duration-300 opacity-0 backdrop-blur-sm">
    <div class="bg-white w-full max-w-md sm:rounded-2xl rounded-t-2xl p-6 transform transition-transform duration-300 translate-y-full sm:translate-y-0 shadow-2xl h-[85vh] sm:h-auto flex flex-col">
        <div class="flex justify-between items-center mb-4 shrink-0">
            <h2 class="text-xl font-bold text-gray-800 flex items-center gap-2">
                <span class="w-2 h-6 bg-blue-600 rounded-full"></span>
                ë°œì£¼ì„œ ë¯¸ë¦¬ë³´ê¸°
            </h2>
            <button onclick="closeModal()" class="p-2 -mr-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
        </div>

        <div class="flex-1 bg-gray-100 p-4 rounded-xl mb-4 font-mono text-sm overflow-y-auto border border-gray-200 text-gray-700 shadow-inner" id="order-text"></div>

        <div class="grid grid-cols-2 gap-3 shrink-0">
            <button onclick="copyToClipboard()" class="bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-3.5 rounded-xl flex justify-center items-center gap-2 transition-colors shadow-md active:scale-[0.98]">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg>
                í…ìŠ¤íŠ¸ ë³µì‚¬
            </button>
            <button onclick="shareOrder()" class="bg-yellow-400 hover:bg-yellow-500 text-white font-bold py-3.5 rounded-xl flex justify-center items-center gap-2 transition-colors shadow-md active:scale-[0.98] text-yellow-900">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
                ì¹´í†¡ ê³µìœ 
            </button>
        </div>
    </div>
</div>

<script>
    // --- ë°ì´í„°: ì‹¤ì œ ì¥ë¶€ ê¸°ë°˜ ---
    const categories = [
        { id: 'fish', name: 'ğŸŸ í™œì–´' },
        { id: 'seafood', name: 'ğŸ™ í•´ì‚°ë¬¼' },
        { id: 'shellfish', name: 'ğŸš íŒ¨ë¥˜' }
    ];

    const products = {
        'fish': [
            { name: 'ê´‘ì–´ (800~)', unit: 'kg' },
            { name: 'ìš°ëŸ­ (450~550)', unit: 'kg' },
            { name: 'ì†Œìš°ëŸ­', unit: 'kg' },
            { name: 'ì°°ê´‘ì–´', unit: 'ë§ˆë¦¬' },
            { name: 'ë„ë¯¸ (ì°¸ë”)', unit: 'kg' },
            { name: 'ì¤„ë”', unit: 'kg' },
            { name: 'ì•„ë‚˜ê³ ', unit: 'kg' },
            { name: 'ì—°ì–´ (ë§ˆë¦¬)', unit: 'ë§ˆë¦¬' },
            { name: 'ì ì„±ì–´', unit: 'ë§ˆë¦¬' },
            { name: 'ë†ì–´', unit: 'ë§ˆë¦¬' },
            { name: 'ê°•ë„ë‹¤ë¦¬ (ì†Œ)', unit: 'kg' },
            { name: 'ê°•ë„ë‹¤ë¦¬ (ì¤‘)', unit: 'kg' },
            { name: 'ê°ì„±ë”', unit: 'kg' },
            { name: 'ëŒ€ë°©ì–´', unit: 'ë§ˆë¦¬' },
            { name: 'ìˆ­ì–´', unit: 'ë§ˆë¦¬' },
            { name: 'ì†Œë°©ì–´', unit: 'ë§ˆë¦¬' }
        ],
        'seafood': [
            { name: 'ì‚°ë‚™ì§€ (ë§/2kg)', unit: 'ë§' },
            { name: 'ë©ê²Œ', unit: 'kg' },
            { name: 'ëŒë©ê²Œ', unit: 'kg' },
            { name: 'ë¹„ë‹¨ë©ê²Œ', unit: 'kg' },
            { name: 'ê°œë¶ˆ (50ë¯¸)', unit: 'ë§' },
            { name: 'í•´ì‚¼', unit: 'kg' },
            { name: 'ì „ë³µ (18ë¯¸)', unit: 'kg' },
            { name: 'ì „ë³µ (30ë¯¸)', unit: 'kg' },
            { name: 'ì‚°ì˜¤ì§•ì–´', unit: 'ë§ˆë¦¬' },
            { name: 'í™œìƒˆìš°', unit: 'kg' }
        ],
        'shellfish': [
            { name: 'ì¼ì‚°ê°€ë¦¬ë¹„', unit: 'kg' },
            { name: 'ì „ì–´', unit: 'kg' },
            { name: 'í‚¤ì¡°ê°œ', unit: 'ë§ˆë¦¬' },
            { name: 'ì°¸ì†Œë¼(ì†Œ)/ì‚ëš¤ì´', unit: 'kg' },
            { name: 'í™ê°€ë¦¬ë¹„', unit: 'ë§' },
            { name: 'í™í•©', unit: 'ë§' },
            { name: 'ë°”ì§€ë½', unit: 'kg' },
            { name: 'ë°±ìƒí•©', unit: 'kg' }
        ]
    };

    // ìƒíƒœ ê´€ë¦¬: { 'ê´‘ì–´': { order: 0, stock: 0 }, ... }
    let data = {};
    let currentCategory = 'fish';

    // --- ì´ˆê¸°í™” ---
    document.addEventListener('DOMContentLoaded', () => {
        renderTabs();
        renderItems(currentCategory);

        const today = new Date();
        const year = today.getFullYear(); // ì—°ë„ ì¶”ê°€
        const month = today.getMonth() + 1;
        const date = today.getDate();
        const dateStr = `${year}/${month}/${date}`; // ì—°ë„ í¬í•¨ í˜•ì‹ìœ¼ë¡œ ë³€ê²½
        document.getElementById('today-date').innerText = dateStr;
    });

    function renderTabs() {
        const tabsContainer = document.getElementById('category-tabs');
        tabsContainer.innerHTML = categories.map(cat => `
                <button onclick="changeCategory('${cat.id}')"
                    class="whitespace-nowrap px-5 py-3 text-sm font-medium border-b-2 transition-all duration-200 ${currentCategory === cat.id ? 'border-blue-600 text-blue-600 bg-blue-50/50' : 'border-transparent text-gray-500 hover:text-gray-700'}">
                    ${cat.name}
                </button>
            `).join('');
    }

    function changeCategory(id) {
        currentCategory = id;
        renderTabs();
        renderItems(id);
        document.getElementById('item-list').scrollTo({ top: 0, behavior: 'smooth' });
    }

    function renderItems(categoryId) {
        const listContainer = document.getElementById('item-list');
        const items = products[categoryId];

        listContainer.innerHTML = items.map(item => {
            // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì´ˆê¸°í™”
            if (!data[item.name]) data[item.name] = { order: 0, stock: 0 };
            const itemData = data[item.name];
            const isActive = itemData.order > 0 || itemData.stock > 0;

            return `
                <div class="bg-white p-4 rounded-xl border mb-3 transition-all duration-200 ${isActive ? 'border-blue-400 ring-1 ring-blue-400 shadow-sm' : 'border-gray-200 shadow-sm'}">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-gray-800 text-base">${item.name}</h3>
                        <span class="text-xs font-medium text-gray-500 bg-gray-100 px-2 py-1 rounded">ë‹¨ìœ„: ${item.unit}</span>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <!-- ì£¼ë¬¸ëŸ‰ -->
                        <div class="flex flex-col">
                            <label class="text-xs text-blue-600 font-bold mb-1 ml-1">ì£¼ë¬¸ëŸ‰ (ë°œì£¼)</label>
                            <div class="flex items-center bg-blue-50 rounded-lg p-1 border border-blue-100">
                                <button onclick="updateVal('${item.name}', 'order', -1)" class="w-8 h-8 bg-white rounded-md text-blue-600 shadow-sm flex items-center justify-center active:scale-95 border border-blue-100">-</button>
                                <input type="number" readonly value="${itemData.order}" class="w-full text-center bg-transparent font-bold text-lg text-blue-700 focus:outline-none p-0">
                                <button onclick="updateVal('${item.name}', 'order', 1)" class="w-8 h-8 bg-blue-500 rounded-md text-white shadow-sm flex items-center justify-center active:scale-95 hover:bg-blue-600">+</button>
                            </div>
                        </div>

                        <!-- ì¬ê³ ëŸ‰ -->
                        <div class="flex flex-col">
                            <label class="text-xs text-gray-500 font-bold mb-1 ml-1">í˜„ì¬ ì¬ê³ </label>
                            <div class="flex items-center bg-gray-50 rounded-lg p-1 border border-gray-200">
                                <button onclick="updateVal('${item.name}', 'stock', -1)" class="w-8 h-8 bg-white rounded-md text-gray-500 shadow-sm flex items-center justify-center active:scale-95 border border-gray-200">-</button>
                                <input type="number" readonly value="${itemData.stock}" class="w-full text-center bg-transparent font-bold text-lg text-gray-600 focus:outline-none p-0">
                                <button onclick="updateVal('${item.name}', 'stock', 1)" class="w-8 h-8 bg-gray-400 rounded-md text-white shadow-sm flex items-center justify-center active:scale-95 hover:bg-gray-500">+</button>
                            </div>
                        </div>
                    </div>
                </div>
                `;
        }).join('');
    }

    // --- ë¡œì§ ---
    function updateVal(name, type, change) {
        if (!data[name]) data[name] = { order: 0, stock: 0 };

        data[name][type] += change;
        if (data[name][type] < 0) data[name][type] = 0; // ìŒìˆ˜ ë°©ì§€

        // UI ë¶€ë¶„ ì—…ë°ì´íŠ¸ (íš¨ìœ¨ì„ ìœ„í•´ ì „ì²´ ë Œë”ë§ ëŒ€ì‹  ê°’ë§Œ ë³€ê²½ë„ ê°€ëŠ¥í•˜ì§€ë§Œ, ì½”ë“œ ê°„ê²°ì„±ì„ ìœ„í•´ ì¬ë Œë”ë§)
        renderItems(currentCategory);
        updateTotal();
    }

    function updateTotal() {
        // ì£¼ë¬¸ì´ë‚˜ ì¬ê³  ì¤‘ í•˜ë‚˜ë¼ë„ ì…ë ¥ëœ í’ˆëª©ì˜ ìˆ˜
        const count = Object.values(data).filter(item => item.order > 0 || item.stock > 0).length;
        document.getElementById('total-items').innerText = count;
    }

    function resetAll() {
        if (confirm('ì‘ì„± ì¤‘ì¸ ëª¨ë“  ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            data = {};
            renderItems(currentCategory);
            updateTotal();
        }
    }

    // --- ëª¨ë‹¬ ë° í…ìŠ¤íŠ¸ ìƒì„± ---
    const modal = document.getElementById('order-modal');
    const modalContent = modal.querySelector('div');

    function openModal() {
        // ë°ì´í„°ê°€ í•˜ë‚˜ë¼ë„ ìˆëŠ”ì§€ í™•ì¸
        const hasData = Object.values(data).some(item => item.order > 0 || item.stock > 0);

        if (!hasData) {
            alert('ì…ë ¥ëœ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.\nì£¼ë¬¸ëŸ‰ì´ë‚˜ ì¬ê³ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return;
        }

        const today = new Date();
        const year = today.getFullYear(); // ì—°ë„ ì¶”ê°€
        const month = today.getMonth() + 1;
        const date = today.getDate();
        const dateStr = `${year}/${month}/${date} (ì˜¤ëŠ˜)`; // ì—°ë„ í¬í•¨ í˜•ì‹ìœ¼ë¡œ ë³€ê²½

        let text = `[ì–´ì‚¬ì¶œë˜ ì£¼ì•ˆì  ë°œì£¼]\nğŸ“… ë‚ ì§œ: ${dateStr}\n\n`;

        // ì¹´í…Œê³ ë¦¬ë³„ ë£¨í”„
        categories.forEach(cat => {
            const catItems = products[cat.id];
            // í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì— ì…ë ¥ëœ ì•„ì´í…œì´ ìˆëŠ”ì§€ í™•ì¸
            const activeItems = catItems.filter(item => {
                const d = data[item.name];
                return d && (d.order > 0 || d.stock > 0);
            });

            if (activeItems.length > 0) {
                text += `â–  ${cat.name}\n`;
                text += `(í’ˆëª…) : (ì£¼ë¬¸) / (ì¬ê³ )\n`;
                text += `--------------------\n`;

                activeItems.forEach(item => {
                    const d = data[item.name];
                    // ì£¼ë¬¸ì´ë‚˜ ì¬ê³ ê°€ 0ì´ë©´ '-'ë¡œ í‘œì‹œí•˜ê±°ë‚˜ 0ìœ¼ë¡œ í‘œì‹œ
                    const orderStr = d.order > 0 ? `${d.order}${item.unit}` : '-';
                    const stockStr = d.stock > 0 ? `${d.stock}${item.unit}` : '-';

                    text += `${item.name}\n`;
                    text += `ğŸ‘‰ ì£¼ë¬¸: ${orderStr}  |  ì¬ê³ : ${stockStr}\n\n`;
                });
                text += `\n`;
            }
        });

        text += `ìˆ˜ê³ í•˜ì‹­ë‹ˆë‹¤. í™•ì¸ ë¶€íƒë“œë¦½ë‹ˆë‹¤!`;

        document.getElementById('order-text').innerText = text;

        modal.classList.remove('hidden');
        setTimeout(() => {
            modal.classList.remove('opacity-0');
            modalContent.classList.remove('translate-y-full');
        }, 10);
    }

    function closeModal() {
        modal.classList.add('opacity-0');
        modalContent.classList.add('translate-y-full');
        setTimeout(() => {
            modal.classList.add('hidden');
        }, 300);
    }

    function copyToClipboard() {
        const text = document.getElementById('order-text').innerText;
        const textArea = document.createElement("textarea");
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        try {
            document.execCommand('copy');
            alert('í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì¹´í†¡ì´ë‚˜ ë¬¸ìì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.');
        } catch (err) {
            alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        }
        document.body.removeChild(textArea);
    }

    function shareOrder() {
        const text = document.getElementById('order-text').innerText;
        if (navigator.share) {
            navigator.share({
                title: 'ì–´ì‚¬ì¶œë˜ ë°œì£¼ì„œ',
                text: text,
            }).catch(console.error);
        } else {
            copyToClipboard(); // ê³µìœ  ë¯¸ì§€ì› ì‹œ ë³µì‚¬ë¡œ ëŒ€ì²´
        }
    }
</script>
</body>
</html>